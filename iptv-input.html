<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV URL Entry</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 24px;
            font-weight: 600;
        }

        .subtitle {
            text-align: center;
            opacity: 0.8;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
        }

        input[type="url"] {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            box-sizing: border-box;
            backdrop-filter: blur(5px);
        }

        input[type="url"]::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        input[type="url"]:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.2);
        }

        .button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.4);
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(238, 90, 36, 0.6);
        }

        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 4px 15px rgba(238, 90, 36, 0.4);
        }

        .status {
            margin-top: 20px;
            padding: 12px 16px;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
            min-height: 20px;
        }

        .status.success {
            background: rgba(39, 174, 96, 0.2);
            border: 1px solid rgba(39, 174, 96, 0.4);
            color: #2ecc71;
        }

        .status.error {
            background: rgba(231, 76, 60, 0.2);
            border: 1px solid rgba(231, 76, 60, 0.4);
            color: #e74c3c;
        }

        .status.info {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid rgba(52, 152, 219, 0.4);
            color: #3498db;
        }

        .status.warning {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid rgba(255, 193, 7, 0.4);
            color: #f39c12;
        }

        .examples {
            margin-top: 20px;
            font-size: 12px;
            opacity: 0.7;
        }

        .examples h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
        }

        .examples ul {
            margin: 0;
            padding-left: 20px;
        }

        .examples li {
            margin-bottom: 4px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .rate-limit-notice {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 8px;
            font-size: 11px;
            text-align: center;
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 20px;
            }
        }
    </style>
    <script>
        // Language translations
        const translations = {
            en: {
                title: 'üì∫ IPTV Watch',
                subtitle: 'Enter IPTV playlist URL for your device',
                urlLabel: 'IPTV Playlist URL',
                urlPlaceholder: 'https://example.com/playlist.m3u8',
                sendButton: 'Send to Device',
                sending: 'Sending to Device...',
                spamProtection: 'üõ°Ô∏è Spam Protection: Limited to 10 simultaneous sessions. Sessions expire after 10 minutes.',
                supportedFormats: 'Supported formats:',
                format1: 'M3U/M3U8 playlists (.m3u, .m3u8)',
                format2: 'Xtream Codes API URLs',
                format3: 'Direct streaming URLs',
                format4: 'Panel API endpoints',
                legalNotice: '‚öñÔ∏è Legal Notice: This tool is designed for accessing legally owned IPTV content. Users are responsible for ensuring they have proper authorization to access any streaming content. Do not use this tool for accessing copyrighted material without permission.',
                errorNoSession: 'Error: No session ID found in URL',
                errorInvalidSession: 'Error: Invalid session ID format',
                sessionInfo: 'Session: ',
                rateLimited: 'Rate limited. Please wait',
                seconds: 'seconds.',
                enterUrl: 'Please enter a URL',
                invalidUrl: 'Invalid URL: ',
                onlyHttpAllowed: 'Only HTTP and HTTPS URLs are allowed',
                localhostBlocked: 'Localhost and private URLs are not allowed',
                invalidUrlFormat: 'Invalid URL format',
                urlAccepted: 'URL accepted (no IPTV patterns detected)',
                validIptvUrl: 'Valid IPTV URL',
                noIptvWarning: 'URL does not contain common IPTV patterns. Continue anyway?',
                sendingToDevice: 'Sending URL to your device...',
                successMessage: '‚úÖ URL sent successfully! Check your device.',
                successClose: '‚úÖ Done! You can close this tab and check your device.',
                errorSending: 'Error: Could not send URL. Please try again.',
                sessionAlreadyUsed: '‚ö†Ô∏è This session has already been used. Please scan a new QR code.',
                checkingSession: 'Checking session status...'
            },
            es: {
                title: 'üì∫ IPTV Ver',
                subtitle: 'Ingrese la URL de la lista IPTV para su dispositivo',
                urlLabel: 'URL de Lista IPTV',
                urlPlaceholder: 'https://ejemplo.com/lista.m3u8',
                sendButton: 'Enviar al Dispositivo',
                sending: 'Enviando al Dispositivo...',
                spamProtection: 'üõ°Ô∏è Protecci√≥n Anti-Spam: Limitado a 10 sesiones simult√°neas. Las sesiones expiran despu√©s de 10 minutos.',
                supportedFormats: 'Formatos soportados:',
                format1: 'Listas M3U/M3U8 (.m3u, .m3u8)',
                format2: 'URLs de API Xtream Codes',
                format3: 'URLs de streaming directo',
                format4: 'Endpoints de API Panel',
                legalNotice: '‚öñÔ∏è Aviso Legal: Esta herramienta est√° dise√±ada para acceder a contenido IPTV de propiedad legal. Los usuarios son responsables de asegurarse de tener la autorizaci√≥n adecuada para acceder a cualquier contenido de streaming. No use esta herramienta para acceder a material con derechos de autor sin permiso.',
                errorNoSession: 'Error: No se encontr√≥ ID de sesi√≥n en la URL',
                errorInvalidSession: 'Error: Formato de ID de sesi√≥n inv√°lido',
                sessionInfo: 'Sesi√≥n: ',
                rateLimited: 'L√≠mite alcanzado. Por favor espere',
                seconds: 'segundos.',
                enterUrl: 'Por favor ingrese una URL',
                invalidUrl: 'URL inv√°lida: ',
                onlyHttpAllowed: 'Solo se permiten URLs HTTP y HTTPS',
                localhostBlocked: 'No se permiten URLs localhost y privadas',
                invalidUrlFormat: 'Formato de URL inv√°lido',
                urlAccepted: 'URL aceptada (no se detectaron patrones IPTV)',
                validIptvUrl: 'URL IPTV v√°lida',
                noIptvWarning: 'La URL no contiene patrones IPTV comunes. ¬øContinuar de todos modos?',
                sendingToDevice: 'Enviando URL a su dispositivo...',
                successMessage: '‚úÖ ¬°URL enviada con √©xito! Verifique su dispositivo.',
                successClose: '‚úÖ ¬°Listo! Puede cerrar esta pesta√±a y verificar su dispositivo.',
                errorSending: 'Error: No se pudo enviar la URL. Por favor intente de nuevo.',
                sessionAlreadyUsed: '‚ö†Ô∏è Esta sesi√≥n ya ha sido utilizada. Por favor escanee un nuevo c√≥digo QR.',
                checkingSession: 'Verificando estado de la sesi√≥n...'
            },
            fr: {
                title: 'üì∫ IPTV Regarder',
                subtitle: "Entrez l'URL de la liste IPTV pour votre appareil",
                urlLabel: 'URL de la Liste IPTV',
                urlPlaceholder: 'https://exemple.com/liste.m3u8',
                sendButton: "Envoyer √† l'Appareil",
                sending: "Envoi √† l'Appareil...",
                spamProtection: 'üõ°Ô∏è Protection Anti-Spam: Limit√© √† 10 sessions simultan√©es. Les sessions expirent apr√®s 10 minutes.',
                supportedFormats: 'Formats support√©s:',
                format1: 'Listes M3U/M3U8 (.m3u, .m3u8)',
                format2: 'URLs API Xtream Codes',
                format3: 'URLs de streaming direct',
                format4: 'Points de terminaison API Panel',
                legalNotice: "‚öñÔ∏è Avis L√©gal: Cet outil est con√ßu pour acc√©der au contenu IPTV l√©galement poss√©d√©. Les utilisateurs sont responsables de s'assurer qu'ils ont l'autorisation appropri√©e pour acc√©der √† tout contenu de streaming. N'utilisez pas cet outil pour acc√©der √† du mat√©riel prot√©g√© par des droits d'auteur sans autorisation.",
                errorNoSession: 'Erreur: Aucun ID de session trouv√© dans l\'URL',
                errorInvalidSession: 'Erreur: Format d\'ID de session invalide',
                sessionInfo: 'Session: ',
                rateLimited: 'Limite atteinte. Veuillez attendre',
                seconds: 'secondes.',
                enterUrl: 'Veuillez entrer une URL',
                invalidUrl: 'URL invalide: ',
                onlyHttpAllowed: 'Seules les URLs HTTP et HTTPS sont autoris√©es',
                localhostBlocked: 'Les URLs localhost et priv√©es ne sont pas autoris√©es',
                invalidUrlFormat: 'Format d\'URL invalide',
                urlAccepted: 'URL accept√©e (aucun mod√®le IPTV d√©tect√©)',
                validIptvUrl: 'URL IPTV valide',
                noIptvWarning: "L'URL ne contient pas de mod√®les IPTV courants. Continuer quand m√™me?",
                sendingToDevice: 'Envoi de l\'URL √† votre appareil...',
                successMessage: '‚úÖ URL envoy√©e avec succ√®s! V√©rifiez votre appareil.',
                successClose: '‚úÖ Termin√©! Vous pouvez fermer cet onglet et v√©rifier votre appareil.',
                errorSending: 'Erreur: Impossible d\'envoyer l\'URL. Veuillez r√©essayer.',
                sessionAlreadyUsed: '‚ö†Ô∏è Cette session a d√©j√† √©t√© utilis√©e. Veuillez scanner un nouveau code QR.',
                checkingSession: 'V√©rification du statut de la session...'
            },
            de: {
                title: 'üì∫ IPTV Ansehen',
                subtitle: 'Geben Sie die IPTV-Playlist-URL f√ºr Ihr Ger√§t ein',
                urlLabel: 'IPTV-Playlist-URL',
                urlPlaceholder: 'https://beispiel.com/playlist.m3u8',
                sendButton: 'An Ger√§t senden',
                sending: 'An Ger√§t senden...',
                spamProtection: 'üõ°Ô∏è Spam-Schutz: Begrenzt auf 10 gleichzeitige Sitzungen. Sitzungen laufen nach 10 Minuten ab.',
                supportedFormats: 'Unterst√ºtzte Formate:',
                format1: 'M3U/M3U8-Playlisten (.m3u, .m3u8)',
                format2: 'Xtream Codes API-URLs',
                format3: 'Direkte Streaming-URLs',
                format4: 'Panel-API-Endpunkte',
                legalNotice: '‚öñÔ∏è Rechtlicher Hinweis: Dieses Tool ist f√ºr den Zugriff auf legal besessene IPTV-Inhalte konzipiert. Benutzer sind daf√ºr verantwortlich, sicherzustellen, dass sie die richtige Berechtigung haben, auf Streaming-Inhalte zuzugreifen. Verwenden Sie dieses Tool nicht, um ohne Erlaubnis auf urheberrechtlich gesch√ºtztes Material zuzugreifen.',
                errorNoSession: 'Fehler: Keine Sitzungs-ID in URL gefunden',
                errorInvalidSession: 'Fehler: Ung√ºltiges Sitzungs-ID-Format',
                sessionInfo: 'Sitzung: ',
                rateLimited: 'Limit erreicht. Bitte warten Sie',
                seconds: 'Sekunden.',
                enterUrl: 'Bitte geben Sie eine URL ein',
                invalidUrl: 'Ung√ºltige URL: ',
                onlyHttpAllowed: 'Nur HTTP- und HTTPS-URLs sind erlaubt',
                localhostBlocked: 'Localhost- und private URLs sind nicht erlaubt',
                invalidUrlFormat: 'Ung√ºltiges URL-Format',
                urlAccepted: 'URL akzeptiert (keine IPTV-Muster erkannt)',
                validIptvUrl: 'G√ºltige IPTV-URL',
                noIptvWarning: 'URL enth√§lt keine g√§ngigen IPTV-Muster. Trotzdem fortfahren?',
                sendingToDevice: 'URL wird an Ihr Ger√§t gesendet...',
                successMessage: '‚úÖ URL erfolgreich gesendet! √úberpr√ºfen Sie Ihr Ger√§t.',
                successClose: '‚úÖ Fertig! Sie k√∂nnen diese Registerkarte schlie√üen und Ihr Ger√§t √ºberpr√ºfen.',
                errorSending: 'Fehler: URL konnte nicht gesendet werden. Bitte versuchen Sie es erneut.',
                sessionAlreadyUsed: '‚ö†Ô∏è Diese Sitzung wurde bereits verwendet. Bitte scannen Sie einen neuen QR-Code.',
                checkingSession: 'Sitzungsstatus wird √ºberpr√ºft...'
            }
        };

        // Function to get user's preferred language
        function getUserLanguage() {
            const urlParams = new URLSearchParams(window.location.search);
            const langParam = urlParams.get('lang');
            if (langParam && translations[langParam]) {
                return langParam;
            }

            const browserLang = navigator.language.substring(0, 2);
            if (translations[browserLang]) {
                return browserLang;
            }

            return 'en';
        }

        // Get current language
        const currentLang = getUserLanguage();
        const t = translations[currentLang];

        // Update document language
        document.documentElement.lang = currentLang;
    </script>
</head>
<body>
    <div class="container">
        <h1>üì∫ IPTV Watch</h1>
        <div class="subtitle">Enter IPTV playlist URL for your device</div>

        <div class="form-group">
            <label for="urlInput">IPTV Playlist URL</label>
            <input
                type="url"
                id="urlInput"
                placeholder="https://example.com/playlist.m3u8"
                autocomplete="url"
                spellcheck="false"
            >
        </div>

        <button class="button" onclick="sendUrl()" id="sendButton">
            Send to Device
        </button>

        <div id="status" class="status"></div>

        <div class="rate-limit-notice">
            <strong>üõ°Ô∏è Spam Protection:</strong> Limited to 10 simultaneous sessions. Sessions expire after 10 minutes.
        </div>

        <div class="examples">
            <h3>Supported formats:</h3>
            <ul>
                <li>M3U/M3U8 playlists (.m3u, .m3u8)</li>
                <li>Xtream Codes API URLs</li>
                <li>Direct streaming URLs</li>
                <li>Panel API endpoints</li>
            </ul>

            <div style="margin-top: 20px; padding: 15px; background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); border-radius: 8px; font-size: 11px;">
                <strong>‚öñÔ∏è Legal Notice:</strong> This tool is designed for accessing legally owned IPTV content. Users are responsible for ensuring they have proper authorization to access any streaming content. Do not use this tool for accessing copyrighted material without permission.
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
        import { getDatabase, ref, set } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js';

        // Firebase configuration - Using weargb database with IPTV path
        const firebaseConfig = {
            apiKey: "AIzaSyBp8_V8jjEUq1aGuypS6VV63cFBFap0s6M",
            authDomain: "weargb.firebaseapp.com",
            databaseURL: "https://weargb-default-rtdb.firebaseio.com",
            projectId: "weargb",
            storageBucket: "weargb.firebasestorage.app",
            messagingSenderId: "480332250386",
            appId: "1:480332250386:web:9747cb"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Rate limiting state
        let submitAttempts = 0;
        const MAX_ATTEMPTS_PER_SESSION = 3;
        const RATE_LIMIT_RESET_TIME = 60000; // 1 minute
        let lastAttemptTime = 0;

        // Get session ID from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const sessionId = urlParams.get('session');

        if (!sessionId) {
            document.getElementById('status').textContent = t.errorNoSession;
            document.getElementById('status').className = 'status error';
            document.getElementById('sendButton').disabled = true;
        } else if (!isValidSessionFormat(sessionId)) {
            document.getElementById('status').textContent = t.errorInvalidSession;
            document.getElementById('status').className = 'status error';
            document.getElementById('sendButton').disabled = true;
        } else {
            document.getElementById('status').textContent = t.sessionInfo + sessionId.substring(0, 8) + '...';
            document.getElementById('status').className = 'status info';

            // Check if session has already been consumed on page load
            fetch(`https://weargb-default-rtdb.firebaseio.com/url-sessions/${sessionId}.json`)
                .then(response => response.json())
                .then(sessionData => {
                    if (sessionData && sessionData.consumed === true) {
                        document.getElementById('status').textContent = t.sessionAlreadyUsed;
                        document.getElementById('status').className = 'status error';
                        document.getElementById('sendButton').disabled = true;
                        document.getElementById('urlInput').disabled = true;
                    }
                })
                .catch(error => {
                    console.log('Could not check session status:', error);
                });
        }

        // Validate session ID format (UUID)
        function isValidSessionFormat(sessionId) {
            const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
            return uuidRegex.test(sessionId);
        }

        // Check rate limiting
        function isRateLimited() {
            const now = Date.now();

            // Reset counter if enough time has passed
            if (now - lastAttemptTime > RATE_LIMIT_RESET_TIME) {
                submitAttempts = 0;
            }

            return submitAttempts >= MAX_ATTEMPTS_PER_SESSION;
        }

        // Validate URL for IPTV patterns and security
        function validateUrl(url) {
            try {
                const urlObj = new URL(url);

                // Must be HTTP or HTTPS
                if (!['http:', 'https:'].includes(urlObj.protocol)) {
                    return { valid: false, reason: t.onlyHttpAllowed };
                }

                // Block localhost and private IP ranges
                const blockedPatterns = [
                    'localhost', '127.0.0.1', '192.168.', '10.0.', '172.',
                    'file://', 'ftp://', 'javascript:', 'data:'
                ];

                const isBlocked = blockedPatterns.some(pattern =>
                    url.toLowerCase().includes(pattern)
                );

                if (isBlocked) {
                    return { valid: false, reason: t.localhostBlocked };
                }

                // Check for IPTV patterns (warn but allow)
                const iptvPatterns = ['.m3u', '.m3u8', 'get.php', 'player_api.php', 'output=ts', 'type=m3u'];
                const hasIptvPattern = iptvPatterns.some(pattern =>
                    url.toLowerCase().includes(pattern)
                );

                return {
                    valid: true,
                    hasIptvPattern: hasIptvPattern,
                    reason: hasIptvPattern ? t.validIptvUrl : t.urlAccepted
                };

            } catch (e) {
                return { valid: false, reason: t.invalidUrlFormat };
            }
        }

        // Global function for sending URL to Firebase
        window.sendUrl = async function() {
            const urlInput = document.getElementById('urlInput');
            const sendButton = document.getElementById('sendButton');
            const status = document.getElementById('status');

            const url = urlInput.value.trim();

            // Rate limiting check
            if (isRateLimited()) {
                status.textContent = t.rateLimited + ' ' + Math.ceil((RATE_LIMIT_RESET_TIME - (Date.now() - lastAttemptTime)) / 1000) + ' ' + t.seconds;
                status.className = 'status warning';
                return;
            }

            if (!url) {
                status.textContent = t.enterUrl;
                status.className = 'status error';
                return;
            }

            // Validate URL
            const validation = validateUrl(url);
            if (!validation.valid) {
                status.textContent = t.invalidUrl + validation.reason;
                status.className = 'status error';
                return;
            }

            // Show warning for non-IPTV URLs
            if (!validation.hasIptvPattern) {
                const proceed = confirm(t.noIptvWarning);
                if (!proceed) return;
            }

            // Update rate limiting
            submitAttempts++;
            lastAttemptTime = Date.now();

            // Send URL to Firebase Realtime Database
            try {
                sendButton.disabled = true;
                sendButton.innerHTML = '<span class="loading"></span> ' + t.checkingSession;
                status.textContent = t.checkingSession;
                status.className = 'status info';

                // First check if session has already been consumed
                const checkResponse = await fetch(`https://weargb-default-rtdb.firebaseio.com/url-sessions/${sessionId}.json`);
                if (checkResponse.ok) {
                    const sessionData = await checkResponse.json();
                    if (sessionData && sessionData.consumed === true) {
                        status.textContent = t.sessionAlreadyUsed;
                        status.className = 'status error';
                        sendButton.disabled = false;
                        sendButton.textContent = t.sendButton;
                        return;
                    }
                }

                sendButton.innerHTML = '<span class="loading"></span> ' + t.sending;
                status.textContent = t.sendingToDevice;

                // Write to Firebase with session ID as key (using url-sessions path like wearGB)
                await set(ref(database, `url-sessions/${sessionId}`), {
                    url: url,
                    timestamp: Date.now(),
                    consumed: false,
                    userAgent: navigator.userAgent.substring(0, 100), // Limited info for debugging
                    iptvValidation: validation.hasIptvPattern
                });

                status.textContent = t.successMessage;
                status.className = 'status success';

                // Auto-close after 3 seconds
                setTimeout(() => {
                    try {
                        window.close();
                    } catch (e) {
                        // If we can't close (some browsers block this), show message
                        status.textContent = t.successClose;
                    }
                }, 3000);

            } catch (error) {
                console.error('Error sending URL to Firebase:', error);
                status.textContent = t.errorSending;
                status.className = 'status error';
                sendButton.disabled = false;
                sendButton.textContent = t.sendButton;
            }
        };

        // Initialize UI with translations
        document.addEventListener('DOMContentLoaded', function() {
            // Update all text content with translations
            document.querySelector('h1').textContent = t.title;
            document.querySelector('.subtitle').textContent = t.subtitle;
            document.querySelector('label[for="urlInput"]').textContent = t.urlLabel;
            document.getElementById('urlInput').placeholder = t.urlPlaceholder;
            document.getElementById('sendButton').textContent = t.sendButton;
            document.querySelector('.rate-limit-notice').innerHTML = t.spamProtection;
            document.querySelector('.examples h3').textContent = t.supportedFormats;
            const formatItems = document.querySelectorAll('.examples ul li');
            formatItems[0].textContent = t.format1;
            formatItems[1].textContent = t.format2;
            formatItems[2].textContent = t.format3;
            formatItems[3].textContent = t.format4;
            document.querySelector('.examples > div').innerHTML = t.legalNotice;

            // Auto-focus the URL input for better UX
            document.getElementById('urlInput').focus();
        });

        // Enable Enter key to submit
        document.getElementById('urlInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendUrl();
            }
        });

        // Log session info for debugging (limited info only)
        console.log('IPTV URL Input - Session:', sessionId ? sessionId.substring(0, 8) + '...' : 'none');
        console.log('Firebase initialized successfully');
        console.log('Language:', currentLang);
    </script>
</body>
</html>